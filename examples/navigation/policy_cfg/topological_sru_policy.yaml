# examples/navigation/policy_cfg/topological_sru_policy.yaml

policy_class: MultiInputPolicy
policy:
  feature_extractor_class: StateTargetImageExtractor
  feature_extractor_kwargs:
    activation_fn: leaky_relu
    
    # ================= 激活我們的創新 =================
    use_topological_memory: True
    topological_memory_kwargs:
      memory_size: 100
      tau_new: 0.90  # 相似度低於此值才算新節點，可以調整
      d_min: 2.0     # 物理距離大於此值才算新節點，可以調整
    # ===============================================

    net_arch:
      state:
        mlp_layer: [192]
        bn: False
        ln: True
      target:
        mlp_layer: [192]
        bn: False
        ln: True
      depth:
        input_max_pool_H_W: [12, 16]
        kernel_size: [2, 3, 3]
        channels: [32, 64, 128]
        padding: [0, 0, 0]
        stride: [1, 1, 1]
        cnn_bn: False
        mlp_layer: [192]
        bn: False
        ln: True
      concatenate: False
      
  net_arch:
    recurrent:
      class: MotionModulatedSRUCell # <-- 使用我們的新發明！
      kwargs:
        hidden_size: 192
    mlp_layer: [64, 4] # 決策層的輸出維度
    
  activation_fn: leaky_relu
  output_activation_fn: acceleration_bounded_yaw
  device: cuda

update_env_kwargs:
  action_type: THRUST_YAW
  inertial_frame: START
  target_type: TARGET_VELOCITY_TARGET_DISTANCE